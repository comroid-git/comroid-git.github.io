import java.util.concurrent.TimeUnit

import static java.lang.System.getenv
import static java.lang.System.getenv

ext {
    isAutoDeploy = (rootProject.name != 'repo' && rootProject.name != 'java') || getenv().containsKey("TEAMCITY") || getenv().containsKey("JITPACK")
}

allprojects {
    apply plugin: 'java'

    sourceCompatibility = 11
    targetCompatibility = 11

    ext {
        buildId = TimeUnit.MILLISECONDS.toSeconds(System.currentTimeMillis())
    }
    group 'org.comroid'
    version = '0.41.' + buildId

    compileJava{
        dependsOn ':dependencies'
        options.encoding = 'UTF-8'
    }

    tasks.withType(Javadoc) {
        options {
            encoding = 'UTF-8'
            /*
            links = [
                    "https://docs.oracle.com/javase/8/docs/api/",
                    "https://docs.oracle.com/javaee/7/api/",
                    "https://mewna.github.io/catnip/docs/",
                    //"https://www.javadoc.io/doc/com.discord4j/discord4j-core/3.0.9", // broken
                    "https://docs.javacord.org/api/v/3.0.4/"//,
                    //"https://ci.dv8tion.net/job/JDA/javadoc/" // broken
            ]
            */
        }
    }

    System.out.println("deps " +name != 'status' )
    if (name != 'auth') {
        apply from: 'vars.gradle'
    }

    repositories {
        maven { url 'https://maven.comroid.org' }
        mavenLocal()
        jcenter()
        mavenCentral()
        maven { url 'https://www.jitpack.io' }
    }
}

dependencies {
    testImplementation 'junit:junit:4.13'
    testImplementation 'org.easymock:easymock:4.1'
}

tasks.findByName('wrapper')?.configure {
    gradleVersion = '6.2'
    distributionUrl = "https://services.gradle.org/distributions/gradle-$gradleVersion-all.zip"
}
